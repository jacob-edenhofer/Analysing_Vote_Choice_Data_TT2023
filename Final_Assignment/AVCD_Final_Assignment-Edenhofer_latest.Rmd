---
title: "Did political trust moderate the relationship between economic insecurity and AfD voting in the 2021 \textit{Bundestagswahl}?"
subtitle: "Final AVCD assignment"
author: "Jacob Edenhofer^[jacob.edenhofer@some.ox.ac.uk]"
date: "`r format(Sys.time(), '%d %B %Y')`"
header-includes: 
  - \usepackage[T1]{fontenc}
  - \usepackage{fouriernc}
  - \usepackage{setspace}\onehalfspacing
  - \usepackage{amsfonts}
  - \usepackage{dcolumn}
  - \usepackage{pifont}
  - \usepackage{booktabs} 
  - \usepackage{placeins}
mainfont: fouriernc
output:
  pdf_document:
    fig_caption: true
    keep_tex: true
    includes:
      in_header: preamble.tex
html_document: default
word_document: default
citation_package: natbib
bibliography: references.bib 
link-citations: yes
linkcolor: cyan
urlcolor: magenta
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Preliminaries 

```{r preliminaries, message=FALSE, warning=FALSE}
# load relevant packages 
library(tidyverse)
library(haven)
library(modelsummary)
library(survey)
library(here)
library(ggeffects)
library(margins)

# import data 
gles <- read_dta(paste0(here(), "/Data/german_longitudinal_election_study_cross_section_post_election2021.dta"))
gles1 <- read_dta(paste0(here(), "/Data/gles_panel_wave20.dta"))
```



Next, we will create some new variables: 

```{r data-wrangling}
gles_mod <- gles %>% 
  select(1:100, grep("d38|d4|q18|d63|d18|q63|d17|d8|d7|wum6|q13|q14|q15|q16|q18|q23|q24|q25|q26||q27q35|q37|q46|q78|q79|q125|q143", names(gles))) %>%
  mutate(btw17_zweitstimme = ifelse(q34ba < 0, NA, q34ba),
         btw21_zweitstimme = ifelse(q114ba < 0, NA, q114ba),
         btw21_turnout = ifelse(q111 < 0 | q111 == 8, NA, q111),
         btw21_turnout1 = ifelse(btw21_turnout == 1, 1, 0),
         year_born = ifelse(grepl("-99|frueher", d2a), NA, d2a),
         ostwest2_dummy = ifelse(ostwest2 < 0, NA, ostwest2),
         ostwest_factor = factor(ostwest2_dummy, 
                                 levels = c(0, 1), 
                                 labels = c("ost", "west")),
         sex = ifelse(d1 < 0, NA, d1),
         sex1 = factor(sex, 
                       levels = c(1, 2), 
                       labels = c("male", "female")),
         year_born1 = as.numeric(as.character(year_born)),
         age = 2021 - as.numeric(as.character(year_born)),
         spd_21 = ifelse(btw21_zweitstimme == 4, 1, 0),
         union_21 = ifelse(btw21_zweitstimme == 1, 1, 0),
         gruene_21 = ifelse(btw21_zweitstimme == 6, 1, 0),
         fdp_21 = ifelse(btw21_zweitstimme == 5, 1, 0),
         afd_21 = ifelse(btw21_zweitstimme == 322, 1, 0),
         linke_21 = ifelse(btw21_zweitstimme == 7, 1, 0), 
         spd_to_switch = ifelse(btw21_zweitstimme == 4 & btw17_zweitstimme != 4, 1, 0),
         afd_away_switch = ifelse(btw17_zweitstimme == 322 & btw21_zweitstimme != 322, 1, 0),
         constituency_centric_rep = ifelse(q63a < 0, NA, q63a),
         party_centric_rep = ifelse(q63c < 0, NA, q63c),
         household_income = ifelse(d63 < 0, NA, d63),
         household_income_factor = as.factor(household_income),
         bachelor_dummy = ifelse(d8j1 < 0, NA, d8j1),
         school = ifelse(d7 < 0, NA, d7),
         abitur = ifelse(d7 == 5, 1, 0),
         abitur_factor = ifelse(abitur == 1, "abitur", "no_abitur"),
         urban_rural = ifelse(wum6 < 0, NA, wum6),
         urban_rural_factor = as.factor(urban_rural),
         subjective_class = ifelse(d38 < 0, NA, d38),
         left_right_self = ifelse(q37 < 0, NA, q37),
         left_right_self_factor = as.factor(left_right_self),
         left_right_cdu = ifelse(q35b < 0, NA, q35b),
         left_right_cdu_factor = as.factor(left_right_cdu),
         distance_cdu = (left_right_cdu-left_right_self)^2,
         left_right_csu = ifelse(q35c < 0, NA, q35c),
         left_right_csu_factor = as.factor(left_right_csu),
         distance_csu = (left_right_csu-left_right_self)^2,
         left_right_spd = ifelse(q35d < 0, NA, q35d),
         left_right_spd_factor = as.factor(left_right_spd),
         distance_spd = (left_right_spd-left_right_self)^2,
         left_right_afd = ifelse(q35h < 0, NA, q35h),
         left_right_afd_factor = as.factor(left_right_afd),
         distance_afd = (left_right_afd-left_right_self)^2,
         left_right_fdp = ifelse(q35e < 0, NA, q35e),
         left_right_fdp_factor = as.factor(left_right_fdp),
         distance_fdp = (left_right_fdp-left_right_self)^2,
         left_right_green = ifelse(q35f < 0, NA, q35f),
         left_right_green_factor = as.factor(left_right_green),
         distance_green = (left_right_green-left_right_self)^2,
         left_right_linke = ifelse(q35g < 0, NA, q35g),
         left_right_linke_factor = as.factor(left_right_linke),
         distance_linke = (left_right_linke-left_right_self)^2,
         scholz_love = ifelse(q18b < 0, NA, q18b),
         scholz_love_factor = as.factor(scholz_love),
         finzanz_abgehangt_subjektiv = ifelse(q46a < 0, NA, q46a),
         finzanz_abgehangt_subjektiv_factor = as.factor(finzanz_abgehangt_subjektiv),
         arbeit_abgehant_subjektiv = ifelse(q46b < 0, NA, q46b),
         arbeit_abgehant_subjektiv_factor = as.factor(arbeit_abgehant_subjektiv),
         cancel_culture_subjektiv = ifelse(q46d < 0, NA, q46d),
         cancel_culture_subjektiv_factor = as.factor(cancel_culture_subjektiv),
         infrastruktur_subjektiv = ifelse(q46c < 0, NA, q46c),
         infrastruktur_subjektiv_factor = as.factor(infrastruktur_subjektiv),
         unemployed_last10_yrs = ifelse(d17a < 0, NA, d17a),
         unemployed_last10yrs_months = ifelse(d17b < 0, NA, d17b),
         unemployed_last10yrs_weeks = ifelse(d17c < 0, NA, d17c),
         unemployed_dummy = ifelse(unemployed_last10_yrs != 0, 1, 0),
         unemployed_dummy_factor = as.factor(unemployed_dummy),
         trust_in_politicians = ifelse(q79d < 0, NA, q79d),
         trust_in_politicians_factor = as.factor(trust_in_politicians),
         trust_in_parliament = ifelse(q79b < 0, NA, q79b),
         trust_in_parliament_factor = as.factor(trust_in_parliament),
         trust_in_parties = ifelse(q79c < 0, NA, q79c),
         trust_in_parties_factor = as.factor(trust_in_parties),
         trust_in_public_broadcast = ifelse(q79i < 0, NA, q79i),
         trust_in_public_broadcast_factor = as.factor(trust_in_public_broadcast),
         trust_general = ifelse(q78 < 0, NA, q78),
         trust_general_factor = as.factor(trust_general),
         out_group_minorities_assim = ifelse(q125a < 0, NA, q125a),
         out_group_minorities_assim_factor = as.factor(out_group_minorities_assim),
         out_group_majority_will = ifelse(q125b < 0, NA, q125b),
         out_group_majority_will_factor = as.factor(out_group_majority_will),
         out_group_immig_econ_good = ifelse(q125c < 0, NA, q125c),
         out_group_immig_econ_good_factor = as.factor(out_group_immig_econ_good),
         out_group_immig_culture_threat = ifelse(q125d < 0, NA, q125d),
         out_group_immig_culture_threat_factor = as.factor(out_group_immig_culture_threat),
         out_group_immig_crime = ifelse(q125e < 0, NA, q125e),
         out_group_immig_crime_factor = as.factor(out_group_immig_crime),
         scale_pol_lasceht = ifelse(q18a < 0, NA, q18a),
         scale_pol_scholz = ifelse(q18b < 0, NA, q18b),
         scale_pol_baerbock = ifelse(q18c < 0, NA, q18c),
         econ_current_eval_general = ifelse(q23 < 0, NA, q23), 
         econ_current_eval_general_factor = as.factor(econ_current_eval_general),
         econ_current_personal = ifelse(q13 < 0, NA, q13), 
         econ_current_personal_factor = factor(econ_current_personal),
         econ_personal_gov_resp = ifelse(q15 < 0, NA, q15),
         gender_too_far = ifelse(q27g < 0, NA, q27g),
         gender_too_far_factor = factor(gender_too_far),
         job_loss_year_next2yrs = ifelse(d18 < 0, NA, d18),
         job_loss_year_next2yrs_factor = factor(job_loss_year_next2yrs),
         length_unemp_last10yrs_yrs = ifelse(d17a < 0, NA, d17a),
         length_unemp_last10yrs_mon = ifelse(d17b < 0, NA, d17b),
         unemp_at_least_one_year = ifelse(length_unemp_last10yrs_yrs >= 1, 1, 0),
         unemp_at_least_one_year_factor = factor(unemp_at_least_one_year),
         profession_loss_next2yrs = ifelse(d19 < 0, NA, d19),
         profession_loss_next2yrs_factor = factor(profession_loss_next2yrs),
         profession_current = ifelse(d11 < 0, NA, d11),
         type_of_emp_contract = ifelse(d13 < 0, NA, d13),
         difference_whos_gov = ifelse(q117 < 0, NA, q117),
         difference_whos_gov_factor = factor(difference_whos_gov),
         difference_who_votes = ifelse(q118 < 0, NA, q118),
         difference_who_votes_factor = factor(difference_who_votes))
```



# Introduction 

+ State research questions.

+ Structure of essay. 


# Motivation 

+ case selection 
  + country 
  + election

+ motivating correlation 

# Theory 

+ Ivanov
+ Eichengreen + Tabellini + Dustmann

+ Sonin + Eichengreen + Schäfer/Zürn + Katz/Mair (cartelisation of party system)

+ Write out hypotheses.

+ gap: 
  + no systematic testing of Eichengreen's theory or model
  + mainly historical analytical narratives 

+ while it is beyond the scope of my essay to provide such a systematic test, I will here take a first step. 

+ Why this election? 
    + uncertain time in general 
    + end of Merkel era 
    + distributional consequences of pandemic? 

# Data and variables 

+ GLES Nachwahlbefragung 


## Data source and operationalisation 

+ dependent variable -> binary, Why? 
    + Eichengreen focuses mainly on radical right, as Sonin notes
    + hence focus justified 

+ proxy for economic insecurity -> justification

## Descriptives

+ Do I need this? 


+ How do I operationalise economic insecurity? 
    + unemployed (actual experience) (`unemp_at_least_one_year`)
    + fear of job loss (`job_loss_year_next2yrs`)
    + fear of losing profession or having to change profession (`profession_loss_next2yrs`)
    + subjective evaluation of current economic situation 
    
    
+ How do I operationalise trust? 
   + trust in politicians 
   + trust in parties 
   + trust in parliament 
   
+ How do I operationalise lack of representation? 
   + no difference who one is voting for 
   + no difference who governs
   

# Methodology and Results 



+ Justify model specification.

+ DAG would be cool, but probably not possible.

+ Presentation of results + interpretation.

+ Caveats. 
  
  + not causal, correlational analysis
  
  
```{r simple-models-insecurity}
# simple models 
## job loss fear 
afd_job_loss_fear <- glm(afd_21 ~ job_loss_year_next2yrs + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
## loss of profession 
afd_prof_loss_fear <- glm(afd_21 ~ profession_loss_next2yrs + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
## unemployment experience 
afd_unemp_exp <- glm(afd_21 ~ unemp_at_least_one_year + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
## econ current general situation 
afd_econ_current <- glm(afd_21 ~ econ_current_personal + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)

# modelplot 
modelplot(list(afd_job_loss_fear, afd_prof_loss_fear, 
               afd_unemp_exp, afd_econ_current)) +
  geom_vline(xintercept = 0)
```




```{r simple-models-lack-rep}
# simple models 
## difference gov
afd_diff_gov <- glm(afd_21 ~ difference_whos_gov + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
## difference voting 
afd_prof_loss_fear <- glm(afd_21 ~ difference_who_votes + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
# modelplot
modelplot(list(afd_diff_gov, afd_prof_loss_fear)) +
  geom_vline(xintercept = 0)
```


```{r interaction-models-lack-rep1}
# interaction models 
## difference gov
### job loss fear 
afd_diff_gov_int1 <- glm(afd_21 ~ difference_whos_gov*job_loss_year_next2yrs + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
### profession loss fear
afd_diff_gov_int2 <- glm(afd_21 ~ difference_whos_gov*profession_loss_next2yrs + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
### unemployment experience
afd_diff_gov_int3 <- glm(afd_21 ~ difference_whos_gov*unemp_at_least_one_year + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
### personal current situation
afd_diff_gov_int4 <- glm(afd_21 ~ difference_whos_gov*econ_current_personal + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
# modelplot 
modelplot(list(afd_diff_gov_int1, afd_diff_gov_int2, 
               afd_diff_gov_int3, afd_diff_gov_int4)) +
  geom_vline(xintercept = 0)
```



```{r interaction-models-lack-rep2}
# interaction models 
## difference gov
### job loss fear 
afd_diff_gov_int5 <- glm(afd_21 ~ difference_who_votes*job_loss_year_next2yrs + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
### profession loss fear
afd_diff_gov_int6 <- glm(afd_21 ~ difference_who_votes*profession_loss_next2yrs + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
### unemployment experience
afd_diff_gov_int7 <- glm(afd_21 ~ difference_who_votes*unemp_at_least_one_year + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
### personal current situation
afd_diff_gov_int8 <- glm(afd_21 ~ difference_who_votes*econ_current_personal + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), 
                         data = gles_mod)
# modelplot 
modelplot(list(afd_diff_gov_int5, afd_diff_gov_int6, 
               afd_diff_gov_int7, afd_diff_gov_int8)) +
  geom_vline(xintercept = 0)
```




```{r interaction-models-job-loss}
# models 
## trust in parliament
afd_job_loss_fear_int1 <- glm(afd_21 ~ job_loss_year_next2yrs*trust_in_parliament + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in parties 
afd_job_loss_fear_int2 <- glm(afd_21 ~ job_loss_year_next2yrs*trust_in_parties + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in politicians
afd_job_loss_fear_int3 <- glm(afd_21 ~ job_loss_year_next2yrs*trust_in_politicians + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
# regression table 
modelsummary(list(afd_job_loss_fear_int1, afd_job_loss_fear_int2, afd_job_loss_fear_int3),
             estimate = "{estimate}{stars}")
```


```{r interaction-models-prof-loss}
# models 
## trust in parliament
afd_prof_loss_fear_int1 <- glm(afd_21 ~ profession_loss_next2yrs*trust_in_parliament + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in parties 
afd_prof_loss_fear_int2 <- glm(afd_21 ~ profession_loss_next2yrs*trust_in_parties + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in politicians
afd_prof_loss_fear_int3 <- glm(afd_21 ~ profession_loss_next2yrs*trust_in_politicians + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
# regression table 
modelsummary(list(afd_prof_loss_fear_int1, afd_prof_loss_fear_int2, afd_prof_loss_fear_int3),
             estimate = "{estimate}{stars}")
```


```{r interaction-models-unemp-exp}
# models 
## trust in parliament
afd_unemp_exp_int1 <- glm(afd_21 ~ unemp_at_least_one_year*trust_in_parliament + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in parties 
afd_unemp_exp_int2 <- glm(afd_21 ~ unemp_at_least_one_year*trust_in_parties + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in politicians
afd_unemp_exp_int3 <- glm(afd_21 ~ unemp_at_least_one_year*trust_in_politicians + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
# regression table 
modelsummary(list(afd_unemp_exp_int1, afd_unemp_exp_int2, afd_unemp_exp_int3),
             estimate = "{estimate}{stars}")
```


```{r interaction-models-current-personal}
# models 
## trust in parliament
afd_econ_current_int1 <- glm(afd_21 ~ econ_current_personal*trust_in_parliament + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in parties 
afd_econ_current_int2 <- glm(afd_21 ~ econ_current_personal*trust_in_parties + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
## trust in politicians
afd_econ_current_int3 <- glm(afd_21 ~ econ_current_personal*trust_in_politicians + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                             family = binomial(link = "logit"),
                             data = gles_mod)
# regression table 
modelsummary(list(afd_econ_current_int1, afd_econ_current_int2, afd_econ_current_int3),
             estimate = "{estimate}{stars}")
```







# Conclusion 


# References 



# Appendix 


# Analysis - AfD


### Socio-demographic Correlates 

Relationship between household income and AfD voting

```{r afd-household-income}
afd_income <- glm(afd_21 ~ household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
cplot(afd_income, x = "household_income",
      xvals = seq(1, 13, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Net Monthly Household Income",
                     breaks = seq(1, 13, 1),
                     labels = c("<500€", "[500-750€)",
                                "[750-1000€)", "[1000-1250€)", 
                                "[1250-1500€)", "[1500-2000€)",
                                "[2000-2500€)", "[2500-3000€)",
                                "[3000-4000€)", "[4000-5000€)",
                                "[5000-7000€)", "[7000-10000€)",
                                ">10000€")) +
  labs(y = "Predicted Probability of Voting for the AfD") +
  ylim(c(0, 0.3)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```



Relationship between subjective class and AfD voting


```{r afd-subjective-class}
# model
afd_class <- glm(afd_21 ~ subjective_class + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot
cplot(afd_class, x = "subjective_class", 
      xvals = seq(1, 6, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Subjective Class", 
                     breaks = seq(1, 6, 1), 
                     labels = c("Unterschicht", "Arbeiterschicht", 
                                "Untere Mittelschicht", "mittlere Mittelschicht", "obere Mittelschicht", "Oberschicht")) +
  labs(y = "Predicted Probability of Voting AfD") +
  expand_limits(y = 0.4) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```

What is the relationship between left-right self-placement and AfD voting? 

```{r afd-left-right-self-placement}
afd_left_right_placement <- glm(afd_21 ~ left_right_self + I(left_right_self^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot this model 
cplot(afd_left_right_placement, x = "left_right_self", 
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Left-Right Self-Placement", 
                     breaks = seq(1, 11, 1)) +
  expand_limits(y = 0.3) +
  labs(y = "Predicted Probability of Voting AfD", 
       caption = "'1' indicates respondents who locate themselves on the left of the ideological spectrum, while '11' indicates the opposite.") +
  theme_bw()
```


Relationship between age and AfD voting 

```{r afd-age}
afd_age <- glm(afd_21 ~ age + I(age^2) + household_income + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_age, x = "age", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_line(aes(y = yvals)) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
  scale_x_continuous("Age", breaks = seq(20, 90, 10)) +
  labs(y = "Predicted Probability of Voting AfD") +
  ylim(c(0, 0.15)) +
  theme_bw()
```


Relationship between sex and AfD

```{r afd-sex}
cplot(afd_income, x = "sex1", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Sex", labels = c("Female", "Male")) +
  ylim(c(0, 0.15)) +
  labs(y = "Predicted Probability of Voting AfD", 
       caption = "Covariates include: age, household income, education and rurality of place of residence.") +
  theme_bw()
```

Relationship between education and AfD voting 

```{r afd-education}
cplot(afd_income, x = "abitur_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Education", labels = c("At Least Abitur", 
                                           "No Abitur")) +
  labs(y = "Predicted Probability of Voting AfD", 
       caption = "Covariates include: age, household income, sex and rurality of place of residence.") +
  ylim(c(0, 0.15)) +
  theme_bw()
```


```{r afd-geography}
cplot(afd_income, x = "urban_rural_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Urban-Rural", 
                   labels = c("Grossstadt", "Rand/Vorort grosser Stadt",
                              "Mittel-oder Kleinstadt", "laendliches Dorf",
                              "Einzelgehoeft")) +
 labs(y = "Predicted Probability of Voting AfD") +
 ylim(c(0, 0.35)) +
 theme_bw() +
 theme(axis.text.x = element_text(angle = 15, hjust = 1))
```



```{r afd-ost-west}
cplot(afd_income, x = "ostwest_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Ost-West Dummy", labels = c("Ost", "West")) +
  ylim(c(0, 0.25)) +
  labs(y = "Predicted Probability of Voting AfD") +
  theme_bw()
```

### Attiudinal Correlates

```{r afd-cancel-culture}
afd_cancel_culture <- glm(afd_21 ~ cancel_culture_subjektiv + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot
cplot(afd_cancel_culture, x = "cancel_culture_subjektiv", 
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Subjektiv: Keine freie Meinungsaeusserung moeglich", 
                   breaks = seq(1, 5, 1),
                   labels = c("Stimme voll zu", "Stimme eher zu",
                              "Teils/Teils", "Stimme eher nicht zu",
                              "Stimme ueberhaupt nicht zu")) +
  labs(y = "Predicted Probability of Voting AfD") +
  ylim(c(0, 0.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```

```{r afd-trust-parliament}
afd_trust_parliament <- glm(afd_21 ~ trust_in_parliament + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_trust_parliament, x = "trust_in_parliament",
      xvals = seq(1, 11, 1), draw = F)  %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Bundestag", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting AfD", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.6)) +
  theme_bw()
```



```{r afd-trust-parties}
afd_trust_parties <- glm(afd_21 ~ trust_in_parties + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_trust_parties, x = "trust_in_parties",
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Parteien", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting AfD", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.6)) +
  theme_bw()
```




```{r afd-trust-politicians}
afd_trust_politicians <- glm(afd_21 ~ trust_in_politicians + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_trust_politicians, x = "trust_in_politicians",
      xvals = seq(1, 11, 1), draw = F)  %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Politiker:innen", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting AfD", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.5)) +
  theme_bw()
```


```{r}
afd_trust_unemp_politicians <- glm(afd_21 ~ trust_in_politicians*econ_current_personal + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)

modelplot(afd_trust_unemp_politicians) +
  geom_vline(xintercept = 0, linetype = "dashed")
```




```{r afd-immig-culture-threat}
afd_immig_culture_threat <- glm(afd_21 ~ out_group_immig_culture_threat + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_immig_culture_threat, x = "out_group_immig_culture_threat",
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Deutsche Kultur durch Immigration bedroht", 
                     breaks = seq(1, 5, 1), 
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  labs(y = "Predicted Probability of Voting AfD") +
  ylim(0, 0.5) +
  theme_bw() 
```


```{r afd-immig-crime}
afd_immig_crime <- glm(afd_21 ~ out_group_immig_crime + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_immig_crime, x = "out_group_immig_crime",
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Immigration erhoeht Kriminalitaet in BRD", 
                     breaks = seq(1, 5, 1), 
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  labs(y = "Predicted Probability of Voting AfD") +
  ylim(c(0, 0.4)) +
  theme_bw() 
```


```{r afd-majority-will}
afd_majority_will <- glm(afd_21 ~ out_group_majority_will + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(afd_majority_will, x = "out_group_majority_will", 
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Wille der Mehrheit hat Vorrang", 
                     breaks = seq(1, 5, 1),
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  ylim(c(0, 0.2)) +
  labs(y = "Predicted Probability of Voting AfD") +
  theme_bw()
```


```{r gender}
afd_gender1 <- glm(afd_21 ~ gender_too_far + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, 
                  family = binomial(link = "logit"), 
                  data = gles_mod)
afd_gender2 <- glm(afd_21 ~ gender_too_far + unemployed_dummy + sex1 + age + abitur_factor +  urban_rural_factor + ostwest_factor, 
                  family = binomial(link = "logit"), 
                  data = gles_mod)
afd_gender3 <- glm(afd_21 ~ gender_too_far*econ_current_personal + abitur_factor + sex1 + age + abitur_factor +  urban_rural_factor + ostwest_factor, 
                  family = binomial(link = "logit"), 
                  data = gles_mod)
afd_gender4 <- glm(afd_21 ~ gender_too_far*econ_personal_gov_resp + abitur_factor + sex1 + age + abitur_factor +  urban_rural_factor + ostwest_factor, 
                  family = binomial(link = "logit"), 
                  data = gles_mod)
afd_gender5 <- glm(afd_21 ~ gender_too_far*econ_current_eval_general + abitur_factor + age + abitur_factor +  urban_rural_factor + ostwest_factor, 
                  family = binomial(link = "logit"), 
                  data = gles_mod)

# modelsummary 
modelsummary(list(afd_gender1, afd_gender2, afd_gender3, afd_gender4, afd_gender5), 
             estimate = "{estimate}{stars}", 
             output = "kableExtra") %>%
  kableExtra::kable_styling(latex_options = "scale_down")
```











