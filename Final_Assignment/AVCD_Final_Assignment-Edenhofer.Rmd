---
title: "Analysing Vote Choice Data"
subtitle: "Final assignment"
author: "Jacob Edenhofer^[jacob.edenhofer@some.ox.ac.uk]"
date: "`r format(Sys.time(), '%d %B %Y')`"
header-includes: 
  - \usepackage[T1]{fontenc}
  - \usepackage{fouriernc}
  - \usepackage{setspace}\onehalfspacing
  - \usepackage{amsfonts}
  - \usepackage{dcolumn}
  - \usepackage{pifont}
  - \usepackage{booktabs} 
  - \usepackage{placeins}
mainfont: fouriernc
output:
  pdf_document:
    fig_caption: true
    keep_tex: true
    includes:
      in_header: preamble.tex
html_document: default
word_document: default
citation_package: natbib
bibliography: references.bib 
link-citations: yes
linkcolor: cyan
urlcolor: magenta
---


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```



# Preliminaries 


```{r preliminaries, message=FALSE, warning=FALSE}
# load relevant packages 
library(tidyverse)
library(haven)
library(modelsummary)
library(survey)
library(here)
library(ggeffects)
library(margins)

# import data 
gles <- read_dta(paste0(here(), "/Data/german_longitudinal_election_study_cross_section_post_election2021.dta"))
gles1 <- read_dta(paste0(here(), "/Data/gles_panel_wave20.dta"))
```


Next, we will create some new variables: 

```{r data-wrangling}
gles_mod <- gles %>% 
  select(1:100, grep("d38|d4|q18|d63|d18|q63|d17|d8|d7|wum6|q18|q35|q37|q46|q78|q79|q125|q143", names(gles))) %>%
  mutate(btw17_zweitstimme = ifelse(q34ba < 0, NA, q34ba),
         btw21_zweitstimme = ifelse(q114ba < 0, NA, q114ba),
         btw21_turnout = ifelse(q111 < 0 | q111 == 8, NA, q111),
         btw21_turnout1 = ifelse(btw21_turnout == 1, 1, 0),
         year_born = ifelse(grepl("-99|frueher", d2a), NA, d2a),
         ostwest2_dummy = ifelse(ostwest2 < 0, NA, ostwest2),
         ostwest_factor = factor(ostwest2_dummy, 
                                 levels = c(0, 1), 
                                 labels = c("ost", "west")),
         sex = ifelse(d1 < 0, NA, d1),
         sex1 = factor(sex, levels = c(1, 2), 
                       labels = c("male", "female")),
         year_born1 = as.numeric(as.character(year_born)),
         age = 2021 - as.numeric(as.character(year_born)),
         spd_21 = ifelse(btw21_zweitstimme == 4, 1, 0),
         union_21 = ifelse(btw21_zweitstimme == 1, 1, 0),
         gruene_21 = ifelse(btw21_zweitstimme == 6, 1, 0),
         fdp_21 = ifelse(btw21_zweitstimme == 5, 1, 0),
         afd_21 = ifelse(btw21_zweitstimme == 322, 1, 0),
         linke_21 = ifelse(btw21_zweitstimme == 7, 1, 0), 
         spd_to_switch = ifelse(btw21_zweitstimme == 4 & btw17_zweitstimme != 4, 1, 0),
         afd_away_switch = ifelse(btw17_zweitstimme == 322 & btw21_zweitstimme != 322, 1, 0),
         constituency_centric_rep = ifelse(q63a < 0, NA, q63a),
         party_centric_rep = ifelse(q63c < 0, NA, q63c),
         household_income = ifelse(d63 < 0, NA, d63),
         household_income_factor = as.factor(household_income),
         bachelor_dummy = ifelse(d8j1 < 0, NA, d8j1),
         school = ifelse(d7 < 0, NA, d7),
         abitur = ifelse(d7 == 5, 1, 0),
         abitur_factor = ifelse(abitur == 1, "abitur", "no_abitur"),
         urban_rural = ifelse(wum6 < 0, NA, wum6),
         urban_rural_factor = as.factor(urban_rural),
         subjective_class = ifelse(d38 < 0, NA, d38),
         left_right_self = ifelse(q37 < 0, NA, q37),
         left_right_self_factor = as.factor(left_right_self),
         left_right_cdu = ifelse(q35b < 0, NA, q35b),
         left_right_cdu_factor = as.factor(left_right_cdu),
         distance_cdu = (left_right_cdu-left_right_self)^2,
         left_right_csu = ifelse(q35c < 0, NA, q35c),
         left_right_csu_factor = as.factor(left_right_csu),
         distance_csu = (left_right_csu-left_right_self)^2,
         left_right_spd = ifelse(q35d < 0, NA, q35d),
         left_right_spd_factor = as.factor(left_right_spd),
         distance_spd = (left_right_spd-left_right_self)^2,
         left_right_afd = ifelse(q35h < 0, NA, q35h),
         left_right_afd_factor = as.factor(left_right_afd),
         distance_afd = (left_right_afd-left_right_self)^2,
         left_right_fdp = ifelse(q35e < 0, NA, q35e),
         left_right_fdp_factor = as.factor(left_right_fdp),
         distance_fdp = (left_right_fdp-left_right_self)^2,
         left_right_green = ifelse(q35f < 0, NA, q35f),
         left_right_green_factor = as.factor(left_right_green),
         distance_green = (left_right_green-left_right_self)^2,
         left_right_linke = ifelse(q35g < 0, NA, q35g),
         left_right_linke_factor = as.factor(left_right_linke),
         distance_linke = (left_right_linke-left_right_self)^2,
         scholz_love = ifelse(q18b < 0, NA, q18b),
         scholz_love_factor = as.factor(scholz_love),
         finzanz_abgehangt_subjektiv = ifelse(q46a < 0, NA, q46a),
         finzanz_abgehangt_subjektiv_factor = as.factor(finzanz_abgehangt_subjektiv),
         arbeit_abgehant_subjektiv = ifelse(q46b < 0, NA, q46b),
         arbeit_abgehant_subjektiv_factor = as.factor(arbeit_abgehant_subjektiv),
         cancel_culture_subjektiv = ifelse(q46d < 0, NA, q46d),
         cancel_culture_subjektiv_factor = as.factor(cancel_culture_subjektiv),
         infrastruktur_subjektiv = ifelse(q46c < 0, NA, q46c),
         infrastruktur_subjektiv_factor = as.factor(infrastruktur_subjektiv),
         unemployed_last10_yrs = ifelse(d17a < 0, NA, d17a),
         unemployed_last10yrs_months = ifelse(d17b < 0, NA, d17b),
         unemployed_last10yrs_weeks = ifelse(d17c < 0, NA, d17c),
         unemployed_dummy = ifelse(unemployed_last10_yrs != 0, 1, 0),
         unemployed_dummy_factor = as.factor(unemployed_dummy),
         trust_in_politicians = ifelse(q79d < 0, NA, q79d),
         trust_in_politicians_factor = as.factor(trust_in_politicians),
         trust_in_parliament = ifelse(q79b < 0, NA, q79b),
         trust_in_parliament_factor = as.factor(trust_in_parliament),
         trust_in_parties = ifelse(q79c < 0, NA, q79c),
         trust_in_parties_factor = as.factor(trust_in_parties),
         trust_in_public_broadcast = ifelse(q79i < 0, NA, q79i),
         trust_in_public_broadcast_factor = as.factor(trust_in_public_broadcast),
         trust_general = ifelse(q78 < 0, NA, q78),
         trust_general_factor = as.factor(trust_general),
         out_group_minorities_assim = ifelse(q125a < 0, NA, q125a),
         out_group_minorities_assim_factor = as.factor(out_group_minorities_assim),
         out_group_majority_will = ifelse(q125b < 0, NA, q125b),
         out_group_majority_will_factor = as.factor(out_group_majority_will),
         out_group_immig_econ_good = ifelse(q125c < 0, NA, q125c),
         out_group_immig_econ_good_factor = as.factor(out_group_immig_econ_good),
         out_group_immig_culture_threat = ifelse(q125d < 0, NA, q125d),
         out_group_immig_culture_threat_factor = as.factor(out_group_immig_culture_threat),
         out_group_immig_crime = ifelse(q125e < 0, NA, q125e),
         out_group_immig_crime_factor = as.factor(out_group_immig_crime),
         scale_pol_lasceht = ifelse(q18a < 0, NA, q18a),
         scale_pol_scholz = ifelse(q18b < 0, NA, q18b),
         scale_pol_baerbock = ifelse(q18c < 0, NA, q18c))
```



# Some tentative analysis


## SPD

### Socio-Demographic Correlates 

Relationship between household income and SPD voting


```{r spd-household-income}
spd_income <- glm(spd_21 ~ household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_income, x = "household_income",
      xvals = seq(1, 13, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Net Monthly Household Income",
                     breaks = seq(1, 13, 1),
                     labels = c("<500€", "[500-750€)",
                                "[750-1000€)", "[1000-1250€)", 
                                "[1250-1500€)", "[1500-2000€)",
                                "[2000-2500€)", "[2500-3000€)",
                                "[3000-4000€)", "[4000-5000€)",
                                "[5000-7000€)", "[7000-10000€)",
                                ">10000€")) +
  labs(y = "Predicted Probability of SPD Voting",
       caption = "Covariates include: age, education, gender and rurality of place of residence.") +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```
There is no robust relationship between net monthly household income and voting for the SPD. 

Relationship between subjective class and SPD voting 

```{r spd-subjective-class}
spd_sclass <- glm(spd_21 ~ subjective_class + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_sclass, x = "subjective_class", 
      xvals = seq(1, 6, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Subjective Class", 
                     breaks = seq(1, 6, 1), 
                     labels = c("Unterschicht", "Arbeiterschicht", 
                                "Untere Mittelschicht", "mittlere Mittelschicht", 
                                "obere Mittelschicht", "Oberschicht")) +
  labs(y = "Predicted Probability of Voting SPD", 
       caption = "Covariates include: age, education, gender and rurality of place of residence.") +
  ylim(c(0.1, 0.5)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```

What is the relationship between left-right self-placement and SPD voting? 

```{r spd-left-right-self-placement}
spd_left_right_self <- glm(spd_21 ~ left_right_self + I(left_right_self^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_left_right_self, x = "left_right_self", 
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Left-Right Self-Placement", 
                     breaks = seq(1, 11, 1)) +
  expand_limits(y = 0.5) +
  labs(y = "Predicted Probability of Voting SPD") +
  theme_bw()
```

Relationship between age and SPD voting

```{r spd-age}
spd_age <- glm(spd_21 ~ household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_age, x = "age", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_line(aes(y = yvals)) +
  geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
  scale_x_continuous("Age", breaks = seq(20, 90, 10)) +
  labs(y = "Predicted Probability of Voting SPD") +
  theme_bw()
```

Relationship between sex and SPD voting 

```{r spd-sex}
cplot(spd_income, x = "sex1", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  ylim(c(0.2, 0.4)) +
  scale_x_discrete("Sex", labels = c("Female", "Male")) +
  labs(y = "Predicted Probability of Voting SPD") +
  theme_bw()
```


Relationship between education and SPD

```{r spd-education}
cplot(spd_income, x = "abitur_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) + 
  scale_x_discrete("Education", labels = c("At Least Abitur", "No Abitur")) +
  ylim(c(0.2, 0.4)) +
  labs(y = "Predicted Probability of SPD Voting") +
  theme_bw()
```


```{r spd-ost-west}
cplot(spd_income, x = "ostwest_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Ost-West Dummy", labels = c("Ost", "West")) +
  ylim(c(0.2, 0.4)) +
  labs(y = "Predicted Probability of Voting SPD") +
  theme_bw()
```

### Attiudinal Correlates 

```{r spd-cancel-culture}
# none of the other abgehaengt variables is significant 
spd_cancel_culture <- glm(spd_21 ~ cancel_culture_subjektiv + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_cancel_culture, x = "cancel_culture_subjektiv", 
      xvals = seq(1, 5, 1), draw = F) %>% 
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Subjektiv: Keine freie Meinungsaeusserung moeglich", 
                   breaks = seq(1, 5, 1),
                   labels = c("Stimme voll zu", "Stimme eher zu",
                              "teils/teils", "Stimme eher nicht zu",
                              "Stimme ueberhaupt nicht zu")) +
  labs(y = "Predicted Probability of Voting SPD") +
  ylim(c(0.1, 0.4)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```


```{r spd-trust-parliament}
# general trust is not significant 
# trust in parliament is significant 
spd_trust_parliament <- glm(spd_21 ~ trust_in_parliament + I(trust_in_parliament^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_trust_parliament, x = "trust_in_parliament", 
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Bundestag", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting SPD", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.4)) +
  theme_bw()
```


```{r spd-trust-parties}
# trust in parties 
spd_trust_parties <- glm(spd_21 ~ trust_in_parties + I(trust_in_parties^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_trust_parties, x = "trust_in_parties", 
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Parteien", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting SPD", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.4)) +
  theme_bw()
```


```{r spd-trust-politicians}
# trust in politicians
spd_trust_politicians <- glm(spd_21 ~ trust_in_politicians + I(trust_in_politicians^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_trust_politicians, x = "trust_in_politicians",
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Politiker:innen", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting SPD", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.4)) +
  theme_bw()
```



```{r spd-immig-crime}
# immigrants bring crime is significant 
spd_immig_crime <- glm(spd_21 ~ out_group_immig_crime + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(spd_immig_crime, x = "out_group_immig_crime", 
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Immigration erhoeht Kriminalitaet in BRD", 
                     breaks = seq(1, 5, 1), 
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  labs(y = "Predicted Probability of Voting SPD") +
  ylim(c(0.1, 0.4)) +
  theme_bw() 
# immigrants pose cultural threat is not significant at 5% level 
# immigrants are good for economics is not significant at 5% level 
# majority will is paramount is not significant 
# outgroups should assimilate not significant 
```





## Gruene


Valence -> 
motivation: Baerbock's campaign 

How can we measure valence vs spatial distance? 

Who punished the Greens because of Baerbock? 
Who punished the CDU/CSU because of Laschet? (Lacher and so on)
-> Those who are struggling / hard times. 

-> egoistic vs sociotropic motivations/evaluations? 
-> egoistic evaluations matter more when one is ideologically closer to a candidate; spell this out
-> sociotropic evaluations matter more when one thinks highly of a candidate




### Spatial distance 

```{r gruene-spatial}
gruene_space <- glm(gruene_21 ~ distance_green + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)


summary(gruene_space)

# placement of greens 
gles_mod %>%
  select(left_right_green_factor, left_right_self_factor) %>%
  filter(!is.na(left_right_green_factor) & !is.na(left_right_self_factor)) %>%
  pivot_longer(cols = everything(), names_to = "type", values_to = "value") %>%
  count(type, value) %>%
  group_by(type) %>%
  mutate(share = 100*(n/sum(n))) %>%
  ggplot(aes(x = value, y = share, fill = type)) +
  geom_col(position = "dodge") +
  geom_text(aes(label = round(share, 1)), vjust = -0.2, size = 2.7,
            position = position_dodge(width = 0.8)) +
  scale_y_continuous("Share of respondents", labels = scales::label_percent(scale = 1)) +
  scale_fill_brewer("", 
                    labels = c("left_right_green_factor" = "L-R placement of Greens", 
                               "left_right_self_factor" = "Self L-R placement")) +
  expand_limits(y = 30) +
  labs(x = "") +
  theme_bw() +
  theme(legend.position = "bottom")
```




### Socio-demographic Correlates 

```{r gruene-income}
gruene_income <- glm(gruene_21 ~ household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_income, x = "household_income", draw = F) %>%
  as_tibble() %>%
   ggplot(aes(x = xvals)) +
   geom_line(aes(y = yvals)) +
   geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) + 
   scale_x_continuous("Net Monthly Household Income",
                     breaks = seq(1, 13, 1),
                     labels = c("<500€", "[500-750€)",
                                "[750-1000€)", "[1000-1250€)", 
                                "[1250-1500€)", "[1500-2000€)",
                                "[2000-2500€)", "[2500-3000€)",
                                "[3000-4000€)", "[4000-5000€)",
                                "[5000-7000€)", "[7000-10000€)",
                                ">10000€")) +
  labs(y = "Predicted Probability of Voting Green") +
  ylim(c(0, 0.2)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```



```{r gruene-subjective-class}
gruene_sclass <- glm(gruene_21 ~ subjective_class + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_sclass, x = "subjective_class", 
      xvals = seq(1, 6, 1),
      draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Subjective Class", 
                     breaks = seq(1, 6, 1), 
                     labels = c("Unterschicht", "Arbeiterschicht", 
                                "Untere Mittelschicht", "mittlere Mittelschicht", "obere Mittelschicht", "Oberschicht")) +
  labs(y = "Predicted Probability of Voting Green") +
  ylim(c(0, 0.25)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```




```{r gruene-geography}
cplot(gruene_income, x = "urban_rural_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Urban-Rural", 
                   labels = c("Grossstadt", "Rand/Vorort grosser Stadt",
                              "Mittel-oder Kleinstadt", "laendliches Dorf",
                              "Einzelgehoeft")) +
 labs(y = "Predicted Probability of Voting Green") +
 ylim(c(0, 0.25)) +
 theme_bw() +
 theme(axis.text.x = element_text(angle = 15, hjust = 1))
```



```{r gruene-age}
# plot 
cplot(gruene_income,
       x = "age", draw = F) %>%
   as_tibble() %>%
   ggplot(aes(x = xvals)) +
   geom_line(aes(y = yvals)) +
   geom_ribbon(aes(ymin = lower, ymax = upper), alpha = 0.2) +
   scale_x_continuous("Age", breaks = seq(20, 90, 10)) +
   ylim(c(0, 0.4)) +
   theme_bw()  
```

```{r gruene-left-right-self-placement}
gruene_left_right_self <- glm(gruene_21 ~ left_right_self + I(left_right_self^2) + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_left_right_self, x = "left_right_self", 
      xvals = seq(1, 11, 1),
      draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Left-Right Self-Placement", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting Green") +
  theme_bw()
```

```{r gruene-education}
cplot(gruene_income, x = "abitur_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Education", labels = c("At Least Abitur", 
                                           "No Abitur")) +
  labs(y = "Predicted Probability of Voting Green", 
       caption = "Covariates include: age, household income, sex, rurality of place of residence and an east-west dummy.") +
  ylim(c(0.05, 0.3)) +
  theme_bw()
```

```{r gruene-ost-west}
cplot(gruene_income, x = "ostwest_factor", draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_discrete("Ost-West Dummy", labels = c("Ost", "West")) +
  ylim(c(0, 0.2)) +
  labs(y = "Predicted Probability of Voting Gruene") +
  theme_bw()
```

### Attiudinal Correlates 


```{r gruene-cancel-culture}
gruene_cancel <- glm(gruene_21 ~ cancel_culture_subjektiv + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot
cplot(gruene_cancel, x = "cancel_culture_subjektiv", 
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Subjektiv: Keine freie Meinungsaeusserung moeglich", 
                   breaks = seq(1, 5, 1),
                   labels = c("Stimme voll zu", "Stimme eher zu",
                              "Teils/Teils", "Stimme eher nicht zu",
                              "Stimme ueberhaupt nicht zu")) +
  labs(y = "Predicted Probability of Voting Green") +
  ylim(c(0, 0.3)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 15, hjust = 1))
```

```{r gruene-trust-parliament}
gruene_trust_parliament <- glm(gruene_21 ~ trust_in_parliament + I(trust_in_parliament^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot
cplot(gruene_trust_parliament, x = "trust_in_parliament", 
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Bundestag", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting Green", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.3)) +
  theme_bw()
```


```{r gruene-trust-parties}
gruene_trust_parties <- glm(gruene_21 ~ trust_in_parties + I(trust_in_parties^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot
cplot(gruene_trust_parties, x = "trust_in_parties",
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Parteien", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting Green", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.3)) +
  theme_bw()
```

```{r gruene-trust-politicians}
gruene_trust_politicians <- glm(gruene_21 ~ trust_in_politicians + I(trust_in_politicians^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_trust_politicians, x = "trust_in_politicians",
      xvals = seq(1, 11, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Vertrauen: Politiker:innen", 
                     breaks = seq(1, 11, 1)) +
  labs(y = "Predicted Probability of Voting Green", 
       caption = "'1' indicates 'no trust', while 11 indicates 'full trust'.") +
  ylim(c(0, 0.3)) +
  theme_bw()
```


```{r gruene-immig-culture-threat}
gruene_immig_culture_threat <- glm(gruene_21 ~ out_group_immig_culture_threat + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_immig_culture_threat, x = "out_group_immig_culture_threat",
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Deutsche Kultur durch Immigration bedroht", 
                     breaks = seq(1, 5, 1), 
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  labs(y = "Predicted Probability of Voting Green") +
  theme_bw() 
```

```{r gruene-immig-crime}
gruene_immig_crime <- glm(gruene_21 ~ out_group_immig_crime + I(out_group_immig_crime^2) + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_immig_crime, x = "out_group_immig_crime",
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Immigration erhoeht Kriminalitaet in BRD", 
                     breaks = seq(1, 5, 1), 
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  labs(y = "Predicted Probability of Voting Green") +
  ylim(c(0, 0.4)) +
  theme_bw() 
```




```{r gruene-majority-will}
gruene_majority <- glm(gruene_21 ~ out_group_majority_will + household_income + age + abitur_factor + sex1 + urban_rural_factor + ostwest_factor, family = binomial(link = "logit"), data = gles_mod)
# plot 
cplot(gruene_majority, x = "out_group_majority_will", 
      xvals = seq(1, 5, 1), draw = F) %>%
  as_tibble() %>%
  ggplot(aes(x = xvals)) +
  geom_point(aes(y = yvals)) +
  geom_errorbar(aes(ymin = lower, ymax = upper), width = 0.2) +
  scale_x_continuous("Wille der Mehrheit hat Vorrang", 
                     breaks = seq(1, 5, 1),
                     labels = c("Stimme voll und ganz zu", "Stimme eher zu", 
                                "Teils/Teils", "Lehne eher ab", 
                                "Lehne voll und ganz ab")) +
  labs(y = "Predicted Probability of Voting Green") +
  theme_bw()
```

















